{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\"\n};\nconst _hoisted_2 = [\"src\"];\nconst _hoisted_3 = {\n  class: \"text-gray-700\"\n};\nconst _hoisted_4 = {\n  class: \"text-gray-700\"\n};\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n  class: \"mt-6\"\n};\nconst _hoisted_7 = {\n  class: \"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center\"\n};\nconst _hoisted_8 = {\n  class: \"bg-white p-4 rounded-lg shadow-md\"\n};\nconst _hoisted_9 = {\n  class: \"text-2xl font-bold text-indigo-600\"\n};\nconst _hoisted_10 = {\n  class: \"bg-white p-4 rounded-lg shadow-md\"\n};\nconst _hoisted_11 = {\n  class: \"text-2xl font-bold text-indigo-600\"\n};\nconst _hoisted_12 = {\n  class: \"bg-white p-4 rounded-lg shadow-md\"\n};\nconst _hoisted_13 = {\n  class: \"text-2xl font-bold text-indigo-600\"\n};\nconst _hoisted_14 = {\n  key: 1,\n  class: \"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center\"\n};\nconst _hoisted_15 = {\n  class: \"bg-white p-6 rounded-lg shadow-lg\"\n};\nconst _hoisted_16 = {\n  class: \"text-gray-800\"\n};\nconst _hoisted_17 = {\n  class: \"mt-4 flex justify-end space-x-4\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_cache[7] || (_cache[7] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-semibold text-gray-800 mb-4\"\n  }, \"Lista de Cartones\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cartons, carton => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: carton.id,\n      class: \"bg-white p-4 rounded-lg shadow-md\"\n    }, [_createElementVNode(\"img\", {\n      src: carton.imageUrl,\n      alt: \"Carton Image\",\n      class: \"w-full h-32 object-cover rounded-md mb-2\"\n    }, null, 8 /* PROPS */, _hoisted_2), _createElementVNode(\"p\", _hoisted_3, \"Serial: \" + _toDisplayString(carton.serial), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_4, \"Estado: \" + _toDisplayString(carton.estado), 1 /* TEXT */), carton.estado === 'asignado' ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 0,\n      onClick: $event => $options.deleteCarton(carton.id),\n      class: \"mt-2 w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300\"\n    }, \" Eliminar \", 8 /* PROPS */, _hoisted_5)) : _createCommentVNode(\"v-if\", true)]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_6, [_cache[6] || (_cache[6] = _createElementVNode(\"h3\", {\n    class: \"text-lg font-semibold text-gray-800 mb-2\"\n  }, \"Estadísticas\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_cache[3] || (_cache[3] = _createElementVNode(\"p\", {\n    class: \"text-gray-600\"\n  }, \"Cartones Disponibles\", -1 /* HOISTED */)), _createElementVNode(\"p\", _hoisted_9, _toDisplayString($data.stats.disponibles), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_10, [_cache[4] || (_cache[4] = _createElementVNode(\"p\", {\n    class: \"text-gray-600\"\n  }, \"Cartones Vendidos\", -1 /* HOISTED */)), _createElementVNode(\"p\", _hoisted_11, _toDisplayString($data.stats.vendidos), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_12, [_cache[5] || (_cache[5] = _createElementVNode(\"p\", {\n    class: \"text-gray-600\"\n  }, \"Vendedores\", -1 /* HOISTED */)), _createElementVNode(\"p\", _hoisted_13, _toDisplayString($data.stats.vendedores), 1 /* TEXT */)])])]), $data.selectedCarton ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.confirmDelete && $options.confirmDelete(...args)),\n    class: \"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300\"\n  }, \" Eliminar \")) : _createCommentVNode(\"v-if\", true), $data.showConfirm ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"p\", _hoisted_16, \"¿Estás seguro de que deseas eliminar el cartón con serial \" + _toDisplayString($data.selectedCarton.serial) + \"? Esta acción no se puede deshacer.\", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.cancelDelete && $options.cancelDelete(...args)),\n    class: \"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600\"\n  }, \"Cancelar\"), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = $event => $options.deleteCarton($data.selectedCarton.id)),\n    class: \"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700\"\n  }, \"Eliminar\")])])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_createElementVNode","_hoisted_1","_Fragment","_renderList","$data","cartons","carton","id","src","imageUrl","alt","_hoisted_2","_hoisted_3","_toDisplayString","serial","_hoisted_4","estado","onClick","$event","$options","deleteCarton","_hoisted_5","_createCommentVNode","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","stats","disponibles","_hoisted_10","_hoisted_11","vendidos","_hoisted_12","_hoisted_13","vendedores","selectedCarton","_cache","args","confirmDelete","showConfirm","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","cancelDelete"],"sources":["D:\\Lotweb\\venta-cartones\\src\\components\\CartonList.vue"],"sourcesContent":["```vue\r\n<template>\r\n  <div>\r\n    <h2 class=\"text-xl font-semibold text-gray-800 mb-4\">Lista de Cartones</h2>\r\n    <div class=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n      <div v-for=\"carton in cartons\" :key=\"carton.id\" class=\"bg-white p-4 rounded-lg shadow-md\">\r\n        <img :src=\"carton.imageUrl\" alt=\"Carton Image\" class=\"w-full h-32 object-cover rounded-md mb-2\" />\r\n        <p class=\"text-gray-700\">Serial: {{ carton.serial }}</p>\r\n        <p class=\"text-gray-700\">Estado: {{ carton.estado }}</p>\r\n        <button\r\n          v-if=\"carton.estado === 'asignado'\"\r\n          @click=\"deleteCarton(carton.id)\"\r\n          class=\"mt-2 w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300\"\r\n        >\r\n          Eliminar\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div class=\"mt-6\">\r\n      <h3 class=\"text-lg font-semibold text-gray-800 mb-2\">Estadísticas</h3>\r\n      <div class=\"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center\">\r\n        <div class=\"bg-white p-4 rounded-lg shadow-md\">\r\n          <p class=\"text-gray-600\">Cartones Disponibles</p>\r\n          <p class=\"text-2xl font-bold text-indigo-600\">{{ stats.disponibles }}</p>\r\n        </div>\r\n        <div class=\"bg-white p-4 rounded-lg shadow-md\">\r\n          <p class=\"text-gray-600\">Cartones Vendidos</p>\r\n          <p class=\"text-2xl font-bold text-indigo-600\">{{ stats.vendidos }}</p>\r\n        </div>\r\n        <div class=\"bg-white p-4 rounded-lg shadow-md\">\r\n          <p class=\"text-gray-600\">Vendedores</p>\r\n          <p class=\"text-2xl font-bold text-indigo-600\">{{ stats.vendedores }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <button\r\n      v-if=\"selectedCarton\"\r\n      @click=\"confirmDelete\"\r\n      class=\"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300\"\r\n    >\r\n      Eliminar\r\n    </button>\r\n    <div v-if=\"showConfirm\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center\">\r\n      <div class=\"bg-white p-6 rounded-lg shadow-lg\">\r\n        <p class=\"text-gray-800\">¿Estás seguro de que deseas eliminar el cartón con serial {{ selectedCarton.serial }}? Esta acción no se puede deshacer.</p>\r\n        <div class=\"mt-4 flex justify-end space-x-4\">\r\n          <button @click=\"cancelDelete\" class=\"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600\">Cancelar</button>\r\n          <button @click=\"deleteCarton(selectedCarton.id)\" class=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700\">Eliminar</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, doc, updateDoc, onSnapshot } from 'firebase/firestore';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cartons: [],\r\n      selectedCarton: null,\r\n      showConfirm: false,\r\n      stats: {\r\n        disponibles: 0,\r\n        vendidos: 0,\r\n        vendedores: 0\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.loadCartons();\r\n    this.loadStats();\r\n  },\r\n  methods: {\r\n    loadCartons() {\r\n      const q = query(collection(db, 'cartones'));\r\n      onSnapshot(q, (querySnapshot) => {\r\n        this.cartons = querySnapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data()\r\n        }));\r\n        console.log('Cartones cargados:', this.cartons);\r\n      }, (error) => {\r\n        console.error('Error al cargar cartones:', error);\r\n        alert('Error al cargar cartones: ' + error.message);\r\n      });\r\n    },\r\n    loadStats() {\r\n      const qCartones = query(collection(db, 'cartones'));\r\n      onSnapshot(qCartones, (querySnapshot) => {\r\n        const cartonsData = querySnapshot.docs.map(doc => doc.data());\r\n        this.stats.disponibles = cartonsData.filter(c => c.estado === 'disponible' && !c.vendedorId).length;\r\n        this.stats.vendidos = cartonsData.filter(c => c.estado === 'vendido').length;\r\n      }, (error) => {\r\n        console.error('Error al cargar estadísticas:', error);\r\n        alert('Error al cargar estadísticas: ' + error.message);\r\n      });\r\n\r\n      const qVendedores = query(collection(db, 'vendedores'));\r\n      onSnapshot(qVendedores, (querySnapshot) => {\r\n        this.stats.vendedores = querySnapshot.size;\r\n      }, (error) => {\r\n        console.error('Error al cargar vendedores:', error);\r\n        alert('Error al cargar vendedores: ' + error.message);\r\n      });\r\n    },\r\n    confirmDelete(carton) {\r\n      this.selectedCarton = carton;\r\n      this.showConfirm = true;\r\n    },\r\n    cancelDelete() {\r\n      this.selectedCarton = null;\r\n      this.showConfirm = false;\r\n    },\r\n    async deleteCarton(cartonId) {\r\n      try {\r\n        console.log('Devolviendo cartón con ID:', cartonId);\r\n        const cartonRef = doc(db, 'cartones', cartonId);\r\n        await updateDoc(cartonRef, {\r\n          vendedorId: null,\r\n          estado: 'disponible'\r\n        });\r\n        console.log('Cartón devuelto a disponible exitosamente');\r\n        alert('Cartón devuelto a disponible exitosamente');\r\n        this.showConfirm = false;\r\n        this.selectedCarton = null;\r\n      } catch (error) {\r\n        console.error('Error al devolver cartón:', error);\r\n        alert('Error al devolver cartón: ' + error.message);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Tailwind maneja los estilos */\r\n</style>\r\n```"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}