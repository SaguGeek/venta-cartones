{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"flex justify-between items-center mb-4\"\n};\nconst _hoisted_2 = [\"disabled\"];\nconst _hoisted_3 = {\n  key: 0,\n  class: \"flex items-center\"\n};\nconst _hoisted_4 = {\n  key: 1\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"bg-white p-4 rounded-lg shadow-md mb-6\"\n};\nconst _hoisted_6 = {\n  class: \"grid grid-cols-1 sm:grid-cols-3 gap-4\"\n};\nconst _hoisted_7 = {\n  class: \"text-center\"\n};\nconst _hoisted_8 = {\n  class: \"text-2xl font-bold text-blue-600\"\n};\nconst _hoisted_9 = {\n  class: \"text-center\"\n};\nconst _hoisted_10 = {\n  class: \"text-2xl font-bold text-green-600\"\n};\nconst _hoisted_11 = {\n  class: \"text-center\"\n};\nconst _hoisted_12 = {\n  class: \"text-2xl font-bold text-purple-600\"\n};\nconst _hoisted_13 = {\n  class: \"mt-4\"\n};\nconst _hoisted_14 = {\n  class: \"text-gray-600\"\n};\nconst _hoisted_15 = {\n  class: \"text-gray-600\"\n};\nconst _hoisted_16 = {\n  key: 1,\n  class: \"text-center text-gray-600\"\n};\nconst _hoisted_17 = {\n  key: 2\n};\nconst _hoisted_18 = {\n  key: 0,\n  class: \"text-gray-600\"\n};\nconst _hoisted_19 = {\n  class: \"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\"\n};\nconst _hoisted_20 = [\"onClick\"];\nconst _hoisted_21 = [\"src\", \"alt\", \"onError\"];\nconst _hoisted_22 = {\n  class: \"text-gray-800 font-medium\"\n};\nconst _hoisted_23 = {\n  class: \"text-gray-600\"\n};\nconst _hoisted_24 = {\n  key: 1,\n  class: \"mt-4 flex justify-center items-center space-x-4\"\n};\nconst _hoisted_25 = [\"disabled\"];\nconst _hoisted_26 = {\n  class: \"text-gray-700\"\n};\nconst _hoisted_27 = [\"disabled\"];\nconst _hoisted_28 = {\n  key: 3,\n  class: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\"\n};\nconst _hoisted_29 = {\n  class: \"bg-white p-6 rounded-lg shadow-lg max-w-lg w-full\"\n};\nconst _hoisted_30 = [\"src\", \"alt\"];\nconst _hoisted_31 = {\n  class: \"text-gray-800 font-medium\"\n};\nconst _hoisted_32 = {\n  class: \"text-gray-600\"\n};\nconst _hoisted_33 = {\n  class: \"mt-4 flex justify-end space-x-4\"\n};\nconst _hoisted_34 = {\n  key: 4,\n  class: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\"\n};\nconst _hoisted_35 = {\n  class: \"bg-white p-6 rounded-lg shadow-lg max-w-lg w-full\"\n};\nconst _hoisted_36 = {\n  class: \"text-gray-600\"\n};\nconst _hoisted_37 = {\n  class: \"mt-4 flex justify-end space-x-4\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_cache[10] || (_cache[10] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-semibold text-gray-800\"\n  }, \"Lista de Cartones\", -1)), _createElementVNode(\"div\", null, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.loadData && $options.loadData(...args)),\n    class: \"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition mr-2 flex items-center\",\n    disabled: $data.loading\n  }, [$data.loading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, _cache[9] || (_cache[9] = [_createElementVNode(\"svg\", {\n    class: \"animate-spin h-5 w-5 mr-2 text-white\",\n    viewBox: \"0 0 24 24\"\n  }, [_createElementVNode(\"circle\", {\n    class: \"opacity-25\",\n    cx: \"12\",\n    cy: \"12\",\n    r: \"10\",\n    stroke: \"currentColor\",\n    \"stroke-width\": \"4\"\n  }), _createElementVNode(\"path\", {\n    class: \"opacity-75\",\n    fill: \"currentColor\",\n    d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n  })], -1), _createTextVNode(\" Cargando... \")]))) : (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \"Refrescar\"))], 8, _hoisted_2), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.downloadReport && $options.downloadReport(...args)),\n    class: \"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition flex items-center\"\n  }, \" Descargar Reporte \")])]), !$data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_cache[14] || (_cache[14] = _createElementVNode(\"h3\", {\n    class: \"text-xl font-medium text-gray-700 mb-2\"\n  }, \"Estadísticas\", -1)), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_cache[11] || (_cache[11] = _createElementVNode(\"p\", {\n    class: \"text-gray-600\"\n  }, \"Cartones Disponibles\", -1)), _createElementVNode(\"p\", _hoisted_8, _toDisplayString($data.availableCartons), 1)]), _createElementVNode(\"div\", _hoisted_9, [_cache[12] || (_cache[12] = _createElementVNode(\"p\", {\n    class: \"text-gray-600\"\n  }, \"Cartones Vendidos\", -1)), _createElementVNode(\"p\", _hoisted_10, _toDisplayString($data.soldCartons), 1)]), _createElementVNode(\"div\", _hoisted_11, [_cache[13] || (_cache[13] = _createElementVNode(\"p\", {\n    class: \"text-gray-600\"\n  }, \"Vendedores\", -1)), _createElementVNode(\"p\", _hoisted_12, _toDisplayString($data.sellerCount), 1)])]), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"p\", _hoisted_14, \"Total de Cartones: \" + _toDisplayString($data.totalCartons), 1), _createElementVNode(\"p\", _hoisted_15, \"Cartones Asignados: \" + _toDisplayString($data.assignedCartons), 1)])])) : _createCommentVNode(\"\", true), $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, \"Cargando cartones...\")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [$data.cartones.length === 0 ? (_openBlock(), _createElementBlock(\"p\", _hoisted_18, \"No hay cartones disponibles.\")) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_19, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.paginatedCartons, carton => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: carton.id,\n      class: \"carton-item bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition cursor-pointer\",\n      onClick: $event => $options.openModal(carton)\n    }, [_createElementVNode(\"img\", {\n      src: carton.imageUrl,\n      alt: 'Cartón ' + carton.serial,\n      class: \"carton-image w-full h-48 object-cover rounded-md mb-2\",\n      onError: $event => $options.handleImageError(carton)\n    }, null, 40, _hoisted_21), _createElementVNode(\"p\", _hoisted_22, [_cache[15] || (_cache[15] = _createElementVNode(\"strong\", null, \"Serial:\", -1)), _createTextVNode(\" \" + _toDisplayString(carton.serial), 1)]), _createElementVNode(\"p\", _hoisted_23, [_cache[16] || (_cache[16] = _createElementVNode(\"strong\", null, \"Estado:\", -1)), _createTextVNode(\" \" + _toDisplayString(carton.estado), 1)])], 8, _hoisted_20);\n  }), 128))]), $options.totalPages > 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_24, [_createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.previousPage && $options.previousPage(...args)),\n    disabled: $data.currentPage === 1,\n    class: _normalizeClass([\"bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition\", {\n      'cursor-not-allowed opacity-50': $data.currentPage === 1\n    }])\n  }, \" Anterior \", 10, _hoisted_25), _createElementVNode(\"span\", _hoisted_26, \"Página \" + _toDisplayString($data.currentPage) + \" de \" + _toDisplayString($options.totalPages), 1), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.nextPage && $options.nextPage(...args)),\n    disabled: $data.currentPage === $options.totalPages,\n    class: _normalizeClass([\"bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition\", {\n      'cursor-not-allowed opacity-50': $data.currentPage === $options.totalPages\n    }])\n  }, \" Siguiente \", 10, _hoisted_27)])) : _createCommentVNode(\"\", true)])), $data.selectedCarton ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [_createElementVNode(\"div\", _hoisted_29, [_cache[19] || (_cache[19] = _createElementVNode(\"h3\", {\n    class: \"text-xl font-semibold text-gray-800 mb-4\"\n  }, \"Detalles del Cartón\", -1)), _createElementVNode(\"img\", {\n    src: $data.selectedCarton.imageUrl,\n    alt: 'Cartón ' + $data.selectedCarton.serial,\n    class: \"w-full h-auto rounded-md mb-4\",\n    onError: _cache[4] || (_cache[4] = $event => $options.handleImageError($data.selectedCarton))\n  }, null, 40, _hoisted_30), _createElementVNode(\"p\", _hoisted_31, [_cache[17] || (_cache[17] = _createElementVNode(\"strong\", null, \"Serial:\", -1)), _createTextVNode(\" \" + _toDisplayString($data.selectedCarton.serial), 1)]), _createElementVNode(\"p\", _hoisted_32, [_cache[18] || (_cache[18] = _createElementVNode(\"strong\", null, \"Estado:\", -1)), _createTextVNode(\" \" + _toDisplayString($data.selectedCarton.estado), 1)]), _createElementVNode(\"div\", _hoisted_33, [$data.selectedCarton.estado === 'asignado' ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.confirmMakeAvailable && $options.confirmMakeAvailable(...args)),\n    class: \"bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition\"\n  }, \" Devolver a Disponible \")) : _createCommentVNode(\"\", true), _createElementVNode(\"button\", {\n    onClick: _cache[6] || (_cache[6] = (...args) => $options.closeModal && $options.closeModal(...args)),\n    class: \"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition\"\n  }, \" Cerrar \")])])])) : _createCommentVNode(\"\", true), $data.showConfirm ? (_openBlock(), _createElementBlock(\"div\", _hoisted_34, [_createElementVNode(\"div\", _hoisted_35, [_cache[20] || (_cache[20] = _createElementVNode(\"h3\", {\n    class: \"text-xl font-semibold text-gray-800 mb-4\"\n  }, \"Confirmar Acción\", -1)), _createElementVNode(\"p\", _hoisted_36, \"¿Estás seguro de que deseas devolver el cartón con serial \" + _toDisplayString($data.selectedCarton.serial) + \" a disponible? Esto permitirá asignarlo a otro vendedor.\", 1), _createElementVNode(\"div\", _hoisted_37, [_createElementVNode(\"button\", {\n    onClick: _cache[7] || (_cache[7] = (...args) => $options.cancelMakeAvailable && $options.cancelMakeAvailable(...args)),\n    class: \"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition\"\n  }, \" Cancelar \"), _createElementVNode(\"button\", {\n    onClick: _cache[8] || (_cache[8] = (...args) => $options.makeAvailable && $options.makeAvailable(...args)),\n    class: \"bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition\"\n  }, \" Confirmar \")])])])) : _createCommentVNode(\"\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_createElementVNode","_hoisted_1","onClick","_cache","args","$options","loadData","disabled","$data","loading","_hoisted_3","viewBox","cx","cy","r","stroke","fill","d","_createTextVNode","_hoisted_4","_hoisted_2","downloadReport","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_toDisplayString","availableCartons","_hoisted_9","_hoisted_10","soldCartons","_hoisted_11","_hoisted_12","sellerCount","_hoisted_13","_hoisted_14","totalCartons","_hoisted_15","assignedCartons","_createCommentVNode","_hoisted_16","_hoisted_17","cartones","length","_hoisted_18","_hoisted_19","_Fragment","_renderList","paginatedCartons","carton","id","$event","openModal","src","imageUrl","alt","serial","onError","handleImageError","_hoisted_21","_hoisted_22","_hoisted_23","estado","_hoisted_20","totalPages","_hoisted_24","previousPage","currentPage","_normalizeClass","_hoisted_25","_hoisted_26","nextPage","_hoisted_27","selectedCarton","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","confirmMakeAvailable","closeModal","showConfirm","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","cancelMakeAvailable","makeAvailable"],"sources":["D:\\Lotweb\\venta-cartones\\src\\components\\CartonList.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"flex justify-between items-center mb-4\">\r\n      <h2 class=\"text-xl font-semibold text-gray-800\">Lista de Cartones</h2>\r\n      <div>\r\n        <button\r\n          @click=\"loadData\"\r\n          class=\"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition mr-2 flex items-center\"\r\n          :disabled=\"loading\"\r\n        >\r\n          <span v-if=\"loading\" class=\"flex items-center\">\r\n            <svg class=\"animate-spin h-5 w-5 mr-2 text-white\" viewBox=\"0 0 24 24\">\r\n              <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n              <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n            </svg>\r\n            Cargando...\r\n          </span>\r\n          <span v-else>Refrescar</span>\r\n        </button>\r\n        <button\r\n          @click=\"downloadReport\"\r\n          class=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition flex items-center\"\r\n        >\r\n          Descargar Reporte\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <!-- Estadísticas -->\r\n    <div v-if=\"!loading\" class=\"bg-white p-4 rounded-lg shadow-md mb-6\">\r\n      <h3 class=\"text-xl font-medium text-gray-700 mb-2\">Estadísticas</h3>\r\n      <div class=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n        <div class=\"text-center\">\r\n          <p class=\"text-gray-600\">Cartones Disponibles</p>\r\n          <p class=\"text-2xl font-bold text-blue-600\">{{ availableCartons }}</p>\r\n        </div>\r\n        <div class=\"text-center\">\r\n          <p class=\"text-gray-600\">Cartones Vendidos</p>\r\n          <p class=\"text-2xl font-bold text-green-600\">{{ soldCartons }}</p>\r\n        </div>\r\n        <div class=\"text-center\">\r\n          <p class=\"text-gray-600\">Vendedores</p>\r\n          <p class=\"text-2xl font-bold text-purple-600\">{{ sellerCount }}</p>\r\n        </div>\r\n      </div>\r\n      <div class=\"mt-4\">\r\n        <p class=\"text-gray-600\">Total de Cartones: {{ totalCartons }}</p>\r\n        <p class=\"text-gray-600\">Cartones Asignados: {{ assignedCartons }}</p>\r\n      </div>\r\n    </div>\r\n    <!-- Lista de Cartones -->\r\n    <div v-if=\"loading\" class=\"text-center text-gray-600\">Cargando cartones...</div>\r\n    <div v-else>\r\n      <p v-if=\"cartones.length === 0\" class=\"text-gray-600\">No hay cartones disponibles.</p>\r\n      <div class=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n        <div\r\n          v-for=\"carton in paginatedCartons\"\r\n          :key=\"carton.id\"\r\n          class=\"carton-item bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition cursor-pointer\"\r\n          @click=\"openModal(carton)\"\r\n        >\r\n          <img\r\n            :src=\"carton.imageUrl\"\r\n            :alt=\"'Cartón ' + carton.serial\"\r\n            class=\"carton-image w-full h-48 object-cover rounded-md mb-2\"\r\n            @error=\"handleImageError(carton)\"\r\n          />\r\n          <p class=\"text-gray-800 font-medium\"><strong>Serial:</strong> {{ carton.serial }}</p>\r\n          <p class=\"text-gray-600\"><strong>Estado:</strong> {{ carton.estado }}</p>\r\n        </div>\r\n      </div>\r\n      <!-- Controles de Paginación -->\r\n      <div v-if=\"totalPages > 1\" class=\"mt-4 flex justify-center items-center space-x-4\">\r\n        <button\r\n          @click=\"previousPage\"\r\n          :disabled=\"currentPage === 1\"\r\n          class=\"bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition\"\r\n          :class=\"{ 'cursor-not-allowed opacity-50': currentPage === 1 }\"\r\n        >\r\n          Anterior\r\n        </button>\r\n        <span class=\"text-gray-700\">Página {{ currentPage }} de {{ totalPages }}</span>\r\n        <button\r\n          @click=\"nextPage\"\r\n          :disabled=\"currentPage === totalPages\"\r\n          class=\"bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition\"\r\n          :class=\"{ 'cursor-not-allowed opacity-50': currentPage === totalPages }\"\r\n        >\r\n          Siguiente\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <!-- Modal de Detalles -->\r\n    <div v-if=\"selectedCarton\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div class=\"bg-white p-6 rounded-lg shadow-lg max-w-lg w-full\">\r\n        <h3 class=\"text-xl font-semibold text-gray-800 mb-4\">Detalles del Cartón</h3>\r\n        <img\r\n          :src=\"selectedCarton.imageUrl\"\r\n          :alt=\"'Cartón ' + selectedCarton.serial\"\r\n          class=\"w-full h-auto rounded-md mb-4\"\r\n          @error=\"handleImageError(selectedCarton)\"\r\n        />\r\n        <p class=\"text-gray-800 font-medium\"><strong>Serial:</strong> {{ selectedCarton.serial }}</p>\r\n        <p class=\"text-gray-600\"><strong>Estado:</strong> {{ selectedCarton.estado }}</p>\r\n        <div class=\"mt-4 flex justify-end space-x-4\">\r\n          <button\r\n            v-if=\"selectedCarton.estado === 'asignado'\"\r\n            @click=\"confirmMakeAvailable\"\r\n            class=\"bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition\"\r\n          >\r\n            Devolver a Disponible\r\n          </button>\r\n          <button\r\n            @click=\"closeModal\"\r\n            class=\"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition\"\r\n          >\r\n            Cerrar\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- Modal de Confirmación -->\r\n    <div v-if=\"showConfirm\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div class=\"bg-white p-6 rounded-lg shadow-lg max-w-lg w-full\">\r\n        <h3 class=\"text-xl font-semibold text-gray-800 mb-4\">Confirmar Acción</h3>\r\n        <p class=\"text-gray-600\">¿Estás seguro de que deseas devolver el cartón con serial {{ selectedCarton.serial }} a disponible? Esto permitirá asignarlo a otro vendedor.</p>\r\n        <div class=\"mt-4 flex justify-end space-x-4\">\r\n          <button\r\n            @click=\"cancelMakeAvailable\"\r\n            class=\"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            @click=\"makeAvailable\"\r\n            class=\"bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition\"\r\n          >\r\n            Confirmar\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { db } from '../firebase';\r\nimport { collection, onSnapshot, doc, updateDoc } from 'firebase/firestore';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cartones: [],\r\n      selectedCarton: null,\r\n      availableCartons: 0,\r\n      soldCartons: 0,\r\n      assignedCartons: 0,\r\n      totalCartons: 0,\r\n      sellerCount: 0,\r\n      loading: false,\r\n      showConfirm: false,\r\n      currentPage: 1,\r\n      itemsPerPage: 8,\r\n      unsubscribeCartons: null,\r\n      unsubscribeSellers: null\r\n    };\r\n  },\r\n  computed: {\r\n    totalPages() {\r\n      return Math.ceil(this.cartones.length / this.itemsPerPage);\r\n    },\r\n    paginatedCartons() {\r\n      const start = (this.currentPage - 1) * this.itemsPerPage;\r\n      const end = start + this.itemsPerPage;\r\n      return this.cartones.slice(start, end);\r\n    }\r\n  },\r\n  async mounted() {\r\n    await this.loadData();\r\n  },\r\n  beforeUnmount() {\r\n    if (this.unsubscribeCartons) {\r\n      this.unsubscribeCartons();\r\n    }\r\n    if (this.unsubscribeSellers) {\r\n      this.unsubscribeSellers();\r\n    }\r\n  },\r\n  methods: {\r\n    async loadData() {\r\n      this.loading = true;\r\n      try {\r\n        await this.loadCartones();\r\n        await this.loadSellers();\r\n      } catch (error) {\r\n        console.error('Error al cargar datos:', error);\r\n        alert('Error al cargar datos: ' + error.message);\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    async loadCartones() {\r\n      try {\r\n        const cartonesRef = collection(db, 'cartones');\r\n        this.unsubscribeCartons = onSnapshot(cartonesRef, (querySnapshot) => {\r\n          this.cartones = querySnapshot.docs.map(doc => ({\r\n            id: doc.id,\r\n            ...doc.data()\r\n          }));\r\n          this.cartones.sort((a, b) => {\r\n            const serialA = parseInt(a.serial.replace('LM', ''), 10);\r\n            const serialB = parseInt(b.serial.replace('LM', ''), 10);\r\n            return serialA - serialB;\r\n          });\r\n          this.availableCartons = this.cartones.filter(c => c.estado === 'disponible').length;\r\n          this.soldCartons = this.cartones.filter(c => c.estado === 'vendido').length;\r\n          this.assignedCartons = this.cartones.filter(c => c.estado === 'asignado').length;\r\n          this.totalCartons = this.cartones.length;\r\n          console.log('Cartones cargados:', this.cartones);\r\n          this.loading = false;\r\n        }, (error) => {\r\n          console.error('Error al escuchar cartones:', error);\r\n          throw error;\r\n        });\r\n      } catch (error) {\r\n        console.error('Error al cargar los cartones:', error);\r\n        throw error;\r\n      }\r\n    },\r\n    async loadSellers() {\r\n      try {\r\n        const sellersRef = collection(db, 'vendedores');\r\n        this.unsubscribeSellers = onSnapshot(sellersRef, (querySnapshot) => {\r\n          this.sellerCount = querySnapshot.docs.length;\r\n        }, (error) => {\r\n          console.error('Error al escuchar vendedores:', error);\r\n          throw error;\r\n        });\r\n      } catch (error) {\r\n        console.error('Error al cargar los vendedores:', error);\r\n        throw error;\r\n      }\r\n    },\r\n    openModal(carton) {\r\n      this.selectedCarton = carton;\r\n    },\r\n    closeModal() {\r\n      this.selectedCarton = null;\r\n      this.showConfirm = false;\r\n    },\r\n    handleImageError(carton) {\r\n      console.error(`Error al cargar la imagen del cartón ${carton.serial}:`, carton.imageUrl);\r\n      carton.imageUrl = null;\r\n    },\r\n    confirmMakeAvailable() {\r\n      this.showConfirm = true;\r\n    },\r\n    cancelMakeAvailable() {\r\n      this.showConfirm = false;\r\n    },\r\n    async makeAvailable() {\r\n      if (!this.selectedCarton) return;\r\n\r\n      try {\r\n        console.log('Devolviendo cartón a disponible:', this.selectedCarton.id);\r\n        const cartonRef = doc(db, 'cartones', this.selectedCarton.id);\r\n        await updateDoc(cartonRef, {\r\n          vendedorId: null,\r\n          estado: 'disponible'\r\n        });\r\n        console.log('Cartón devuelto a disponible exitosamente');\r\n        alert('Cartón devuelto a disponible exitosamente');\r\n        this.showConfirm = false;\r\n        this.selectedCarton = null;\r\n        await this.loadData();\r\n      } catch (error) {\r\n        console.error('Error al devolver cartón a disponible:', error);\r\n        alert('Error al devolver cartón a disponible: ' + error.message);\r\n      }\r\n    },\r\n    previousPage() {\r\n      if (this.currentPage > 1) this.currentPage--;\r\n    },\r\n    nextPage() {\r\n      if (this.currentPage < this.totalPages) this.currentPage++;\r\n    },\r\n    downloadReport() {\r\n      const report = `\r\n        Reporte de Cartones - ${new Date().toLocaleDateString()}\r\n        ======================================\r\n        Total de Cartones: ${this.totalCartons}\r\n        Cartones Disponibles: ${this.availableCartons}\r\n        Cartones Vendidos: ${this.soldCartons}\r\n        Cartones Asignados: ${this.assignedCartons}\r\n        Total de Vendedores: ${this.sellerCount}\r\n        ======================================\r\n        Detalle de Cartones:\r\n        ${this.cartones.map(c => `Serial: ${c.serial}, Estado: ${c.estado}`).join('\\n')}\r\n      `;\r\n      const blob = new Blob([report], { type: 'text/plain' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `reporte_cartones_${new Date().toISOString().split('T')[0]}.txt`;\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Tailwind maneja los estilos */\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}