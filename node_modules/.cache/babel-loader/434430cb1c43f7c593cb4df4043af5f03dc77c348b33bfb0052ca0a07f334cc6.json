{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { db } from '../firebase';\nimport { collection, query, where, getDocs, doc, updateDoc, onSnapshot } from 'firebase/firestore';\nexport default {\n  data() {\n    return {\n      cartons: [],\n      selectedCarton: null,\n      showConfirm: false,\n      stats: {\n        disponibles: 0,\n        vendidos: 0,\n        vendedores: 0\n      }\n    };\n  },\n  mounted() {\n    this.loadCartons();\n    this.loadStats();\n  },\n  methods: {\n    loadCartons() {\n      const q = query(collection(db, 'cartones'));\n      onSnapshot(q, querySnapshot => {\n        this.cartons = querySnapshot.docs.map(doc => ({\n          id: doc.id,\n          ...doc.data()\n        }));\n        console.log('Cartones cargados:', this.cartons);\n      }, error => {\n        console.error('Error al cargar cartones:', error);\n        alert('Error al cargar cartones: ' + error.message);\n      });\n    },\n    loadStats() {\n      const qCartones = query(collection(db, 'cartones'));\n      onSnapshot(qCartones, querySnapshot => {\n        const cartonsData = querySnapshot.docs.map(doc => doc.data());\n        this.stats.disponibles = cartonsData.filter(c => c.estado === 'disponible' && !c.vendedorId).length;\n        this.stats.vendidos = cartonsData.filter(c => c.estado === 'vendido').length;\n      }, error => {\n        console.error('Error al cargar estadísticas:', error);\n        alert('Error al cargar estadísticas: ' + error.message);\n      });\n      const qVendedores = query(collection(db, 'vendedores'));\n      onSnapshot(qVendedores, querySnapshot => {\n        this.stats.vendedores = querySnapshot.size;\n      }, error => {\n        console.error('Error al cargar vendedores:', error);\n        alert('Error al cargar vendedores: ' + error.message);\n      });\n    },\n    confirmDelete(carton) {\n      this.selectedCarton = carton;\n      this.showConfirm = true;\n    },\n    cancelDelete() {\n      this.selectedCarton = null;\n      this.showConfirm = false;\n    },\n    async deleteCarton(cartonId) {\n      try {\n        console.log('Devolviendo cartón con ID:', cartonId);\n        const cartonRef = doc(db, 'cartones', cartonId);\n        await updateDoc(cartonRef, {\n          vendedorId: null,\n          estado: 'disponible'\n        });\n        console.log('Cartón devuelto a disponible exitosamente');\n        alert('Cartón devuelto a disponible exitosamente');\n        this.showConfirm = false;\n        this.selectedCarton = null;\n      } catch (error) {\n        console.error('Error al devolver cartón:', error);\n        alert('Error al devolver cartón: ' + error.message);\n      }\n    }\n  }\n};","map":{"version":3,"names":["db","collection","query","where","getDocs","doc","updateDoc","onSnapshot","data","cartons","selectedCarton","showConfirm","stats","disponibles","vendidos","vendedores","mounted","loadCartons","loadStats","methods","q","querySnapshot","docs","map","id","console","log","error","alert","message","qCartones","cartonsData","filter","c","estado","vendedorId","length","qVendedores","size","confirmDelete","carton","cancelDelete","deleteCarton","cartonId","cartonRef"],"sources":["D:\\Lotweb\\venta-cartones\\src\\components\\CartonList.vue"],"sourcesContent":["```vue\r\n<template>\r\n  <div>\r\n    <h2 class=\"text-xl font-semibold text-gray-800 mb-4\">Lista de Cartones</h2>\r\n    <div class=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n      <div v-for=\"carton in cartons\" :key=\"carton.id\" class=\"bg-white p-4 rounded-lg shadow-md\">\r\n        <img :src=\"carton.imageUrl\" alt=\"Carton Image\" class=\"w-full h-32 object-cover rounded-md mb-2\" />\r\n        <p class=\"text-gray-700\">Serial: {{ carton.serial }}</p>\r\n        <p class=\"text-gray-700\">Estado: {{ carton.estado }}</p>\r\n        <button\r\n          v-if=\"carton.estado === 'asignado'\"\r\n          @click=\"deleteCarton(carton.id)\"\r\n          class=\"mt-2 w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300\"\r\n        >\r\n          Eliminar\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div class=\"mt-6\">\r\n      <h3 class=\"text-lg font-semibold text-gray-800 mb-2\">Estadísticas</h3>\r\n      <div class=\"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center\">\r\n        <div class=\"bg-white p-4 rounded-lg shadow-md\">\r\n          <p class=\"text-gray-600\">Cartones Disponibles</p>\r\n          <p class=\"text-2xl font-bold text-indigo-600\">{{ stats.disponibles }}</p>\r\n        </div>\r\n        <div class=\"bg-white p-4 rounded-lg shadow-md\">\r\n          <p class=\"text-gray-600\">Cartones Vendidos</p>\r\n          <p class=\"text-2xl font-bold text-indigo-600\">{{ stats.vendidos }}</p>\r\n        </div>\r\n        <div class=\"bg-white p-4 rounded-lg shadow-md\">\r\n          <p class=\"text-gray-600\">Vendedores</p>\r\n          <p class=\"text-2xl font-bold text-indigo-600\">{{ stats.vendedores }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <button\r\n      v-if=\"selectedCarton\"\r\n      @click=\"confirmDelete\"\r\n      class=\"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300\"\r\n    >\r\n      Eliminar\r\n    </button>\r\n    <div v-if=\"showConfirm\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center\">\r\n      <div class=\"bg-white p-6 rounded-lg shadow-lg\">\r\n        <p class=\"text-gray-800\">¿Estás seguro de que deseas eliminar el cartón con serial {{ selectedCarton.serial }}? Esta acción no se puede deshacer.</p>\r\n        <div class=\"mt-4 flex justify-end space-x-4\">\r\n          <button @click=\"cancelDelete\" class=\"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600\">Cancelar</button>\r\n          <button @click=\"deleteCarton(selectedCarton.id)\" class=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700\">Eliminar</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, doc, updateDoc, onSnapshot } from 'firebase/firestore';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cartons: [],\r\n      selectedCarton: null,\r\n      showConfirm: false,\r\n      stats: {\r\n        disponibles: 0,\r\n        vendidos: 0,\r\n        vendedores: 0\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.loadCartons();\r\n    this.loadStats();\r\n  },\r\n  methods: {\r\n    loadCartons() {\r\n      const q = query(collection(db, 'cartones'));\r\n      onSnapshot(q, (querySnapshot) => {\r\n        this.cartons = querySnapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data()\r\n        }));\r\n        console.log('Cartones cargados:', this.cartons);\r\n      }, (error) => {\r\n        console.error('Error al cargar cartones:', error);\r\n        alert('Error al cargar cartones: ' + error.message);\r\n      });\r\n    },\r\n    loadStats() {\r\n      const qCartones = query(collection(db, 'cartones'));\r\n      onSnapshot(qCartones, (querySnapshot) => {\r\n        const cartonsData = querySnapshot.docs.map(doc => doc.data());\r\n        this.stats.disponibles = cartonsData.filter(c => c.estado === 'disponible' && !c.vendedorId).length;\r\n        this.stats.vendidos = cartonsData.filter(c => c.estado === 'vendido').length;\r\n      }, (error) => {\r\n        console.error('Error al cargar estadísticas:', error);\r\n        alert('Error al cargar estadísticas: ' + error.message);\r\n      });\r\n\r\n      const qVendedores = query(collection(db, 'vendedores'));\r\n      onSnapshot(qVendedores, (querySnapshot) => {\r\n        this.stats.vendedores = querySnapshot.size;\r\n      }, (error) => {\r\n        console.error('Error al cargar vendedores:', error);\r\n        alert('Error al cargar vendedores: ' + error.message);\r\n      });\r\n    },\r\n    confirmDelete(carton) {\r\n      this.selectedCarton = carton;\r\n      this.showConfirm = true;\r\n    },\r\n    cancelDelete() {\r\n      this.selectedCarton = null;\r\n      this.showConfirm = false;\r\n    },\r\n    async deleteCarton(cartonId) {\r\n      try {\r\n        console.log('Devolviendo cartón con ID:', cartonId);\r\n        const cartonRef = doc(db, 'cartones', cartonId);\r\n        await updateDoc(cartonRef, {\r\n          vendedorId: null,\r\n          estado: 'disponible'\r\n        });\r\n        console.log('Cartón devuelto a disponible exitosamente');\r\n        alert('Cartón devuelto a disponible exitosamente');\r\n        this.showConfirm = false;\r\n        this.selectedCarton = null;\r\n      } catch (error) {\r\n        console.error('Error al devolver cartón:', error);\r\n        alert('Error al devolver cartón: ' + error.message);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Tailwind maneja los estilos */\r\n</style>\r\n```"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}