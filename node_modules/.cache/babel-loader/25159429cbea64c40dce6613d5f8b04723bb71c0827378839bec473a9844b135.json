{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-purple-900\"\n};\nconst _hoisted_2 = {\n  class: \"bg-gray-800 bg-opacity-90 shadow-xl sticky top-0 z-50 backdrop-blur-md\"\n};\nconst _hoisted_3 = {\n  class: \"container mx-auto px-6 py-4 flex justify-between items-center\"\n};\nconst _hoisted_4 = {\n  class: \"container mx-auto px-6 py-10\"\n};\nconst _hoisted_5 = {\n  class: \"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8\"\n};\nconst _hoisted_6 = {\n  class: \"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\"\n};\nconst _hoisted_7 = {\n  class: \"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\"\n};\nconst _hoisted_8 = {\n  class: \"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\"\n};\nconst _hoisted_9 = {\n  class: \"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_UploadCarton = _resolveComponent(\"UploadCarton\");\n  const _component_AssignCartons = _resolveComponent(\"AssignCartons\");\n  const _component_CartonList = _resolveComponent(\"CartonList\");\n  const _component_SellerList = _resolveComponent(\"SellerList\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" Barra de Navegación \"), _createElementVNode(\"header\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n    class: \"flex items-center space-x-4\"\n  }, [_createElementVNode(\"span\", {\n    class: \"text-3xl font-extrabold text-purple-400 animate-pulse\"\n  }, \"VC\"), _createElementVNode(\"h1\", {\n    class: \"text-2xl font-bold text-white tracking-wide\"\n  }, \"Dashboard Admin\")], -1 /* HOISTED */)), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.logout && $options.logout(...args)),\n    class: \"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-5 py-2 rounded-full hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-purple-400 focus:ring-opacity-50 transition-all duration-300 transform hover:scale-105\"\n  }, \" Cerrar Sesión \")])]), _createCommentVNode(\" Contenido Principal \"), _createElementVNode(\"main\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createCommentVNode(\" Sección de Subir Cartones \"), _createElementVNode(\"div\", _hoisted_6, [_cache[2] || (_cache[2] = _createElementVNode(\"h2\", {\n    class: \"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\"\n  }, \"Subir Cartones\", -1 /* HOISTED */)), _createVNode(_component_UploadCarton, {\n    onCheckDuplicates: $options.checkDuplicates,\n    onImagesUploaded: $options.handleImagesUploaded\n  }, null, 8 /* PROPS */, [\"onCheckDuplicates\", \"onImagesUploaded\"])]), _createCommentVNode(\" Sección de Asignar Cartones \"), _createElementVNode(\"div\", _hoisted_7, [_cache[3] || (_cache[3] = _createElementVNode(\"h2\", {\n    class: \"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\"\n  }, \"Asignar Cartones\", -1 /* HOISTED */)), _createVNode(_component_AssignCartons, {\n    onCartonesAsignados: $options.refreshCartones\n  }, null, 8 /* PROPS */, [\"onCartonesAsignados\"])]), _createCommentVNode(\" Sección de Lista de Cartones \"), _createElementVNode(\"div\", _hoisted_8, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", {\n    class: \"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\"\n  }, \"Lista de Cartones\", -1 /* HOISTED */)), _createVNode(_component_CartonList, {\n    ref: \"cartonList\"\n  }, null, 512 /* NEED_PATCH */)]), _createCommentVNode(\" Sección de Lista de Vendedores \"), _createElementVNode(\"div\", _hoisted_9, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", {\n    class: \"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\"\n  }, \"Lista de Vendedores\", -1 /* HOISTED */)), _createVNode(_component_SellerList)])])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","_hoisted_3","onClick","_cache","args","$options","logout","_hoisted_4","_hoisted_5","_hoisted_6","_createVNode","_component_UploadCarton","onCheckDuplicates","checkDuplicates","onImagesUploaded","handleImagesUploaded","_hoisted_7","_component_AssignCartons","onCartonesAsignados","refreshCartones","_hoisted_8","_component_CartonList","ref","_hoisted_9","_component_SellerList"],"sources":["D:\\Lotweb\\venta-cartones\\src\\views\\HomePage.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-purple-900\">\r\n    <!-- Barra de Navegación -->\r\n    <header class=\"bg-gray-800 bg-opacity-90 shadow-xl sticky top-0 z-50 backdrop-blur-md\">\r\n      <div class=\"container mx-auto px-6 py-4 flex justify-between items-center\">\r\n        <div class=\"flex items-center space-x-4\">\r\n          <span class=\"text-3xl font-extrabold text-purple-400 animate-pulse\">VC</span>\r\n          <h1 class=\"text-2xl font-bold text-white tracking-wide\">Dashboard Admin</h1>\r\n        </div>\r\n        <button\r\n          @click=\"logout\"\r\n          class=\"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-5 py-2 rounded-full hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-purple-400 focus:ring-opacity-50 transition-all duration-300 transform hover:scale-105\"\r\n        >\r\n          Cerrar Sesión\r\n        </button>\r\n      </div>\r\n    </header>\r\n\r\n    <!-- Contenido Principal -->\r\n    <main class=\"container mx-auto px-6 py-10\">\r\n      <div class=\"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8\">\r\n        <!-- Sección de Subir Cartones -->\r\n        <div class=\"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\">\r\n          <h2 class=\"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\">Subir Cartones</h2>\r\n          <UploadCarton @check-duplicates=\"checkDuplicates\" @images-uploaded=\"handleImagesUploaded\" />\r\n        </div>\r\n\r\n        <!-- Sección de Asignar Cartones -->\r\n        <div class=\"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\">\r\n          <h2 class=\"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\">Asignar Cartones</h2>\r\n          <AssignCartons @cartones-asignados=\"refreshCartones\" />\r\n        </div>\r\n\r\n        <!-- Sección de Lista de Cartones -->\r\n        <div class=\"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\">\r\n          <h2 class=\"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\">Lista de Cartones</h2>\r\n          <CartonList ref=\"cartonList\" />\r\n        </div>\r\n\r\n        <!-- Sección de Lista de Vendedores -->\r\n        <div class=\"bg-white bg-opacity-90 backdrop-blur-lg p-8 rounded-2xl shadow-2xl transition-all duration-500 hover:shadow-3xl hover:-translate-y-2\">\r\n          <h2 class=\"text-2xl font-semibold text-gray-800 mb-6 tracking-tight\">Lista de Vendedores</h2>\r\n          <SellerList />\r\n        </div>\r\n      </div>\r\n    </main>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UploadCarton from '../components/UploadCarton.vue';\r\nimport AssignCartons from '../components/AssignCartons.vue';\r\nimport CartonList from '../components/CartonList.vue';\r\nimport SellerList from '../components/SellerList.vue';\r\nimport { db } from '../firebase';\r\nimport { collection, query, where, getDocs, addDoc } from 'firebase/firestore';\r\nimport { auth } from '../firebase';\r\nimport { signOut } from 'firebase/auth';\r\n\r\nexport default {\r\n  name: 'HomePage',\r\n  components: {\r\n    UploadCarton,\r\n    AssignCartons,\r\n    CartonList,\r\n    SellerList\r\n  },\r\n  data() {\r\n    return {\r\n      inactivityTimeout: null,\r\n      inactivityLimit: 15 * 60 * 1000 // 15 minutos en milisegundos\r\n    };\r\n  },\r\n  mounted() {\r\n    this.setupInactivityTimer();\r\n  },\r\n  beforeUnmount() {\r\n    this.clearInactivityTimer();\r\n  },\r\n  methods: {\r\n    async checkDuplicates({ serials, files }, callback) {\r\n      try {\r\n        const cartonesRef = collection(db, 'cartones');\r\n        const q = query(cartonesRef, where('serial', 'in', serials));\r\n        const querySnapshot = await getDocs(q);\r\n        const existingSerials = querySnapshot.docs.map(doc => doc.data().serial);\r\n        const nonDuplicates = files.filter(file => !existingSerials.includes(file.name.split('.')[0]));\r\n        callback(nonDuplicates);\r\n      } catch (error) {\r\n        console.error('Error al verificar duplicados:', error);\r\n        alert('Error al verificar duplicados: ' + error.message);\r\n        callback([]);\r\n      }\r\n    },\r\n    async handleImagesUploaded(images) {\r\n      let successCount = 0;\r\n      try {\r\n        for (const image of images) {\r\n          if (image.serial && image.imageUrl) {\r\n            const docRef = await addDoc(collection(db, 'cartones'), {\r\n              serial: image.serial,\r\n              imageUrl: image.imageUrl,\r\n              estado: 'disponible',\r\n              createdAt: new Date(),\r\n              vendedorId: null\r\n            });\r\n            console.log(`Cartón ${image.serial} guardado con ID:`, docRef.id);\r\n            successCount++;\r\n          } else if (typeof image === 'string') {\r\n            const serial = this.selectedFiles.find(file => file.name.includes(image.split('/').pop().split('.')[0]))?.name.split('.')[0];\r\n            if (serial) {\r\n              const docRef = await addDoc(collection(db, 'cartones'), {\r\n                serial: serial,\r\n                imageUrl: image,\r\n                estado: 'disponible',\r\n                createdAt: new Date(),\r\n                vendedorId: null\r\n              });\r\n              console.log(`Cartón ${serial} guardado con ID:`, docRef.id);\r\n              successCount++;\r\n            }\r\n          }\r\n        }\r\n        alert(`${successCount} de ${images.length} cartones se guardaron exitosamente en Firestore`);\r\n      } catch (error) {\r\n        console.error('Error al guardar los cartones:', error);\r\n        alert(`Error al guardar los cartones: ${error.message}. Se guardaron ${successCount} de ${images.length} cartones.`);\r\n      }\r\n    },\r\n    async refreshCartones() {\r\n      if (this.$refs.cartonList && typeof this.$refs.cartonList.loadCartones === 'function') {\r\n        await this.$refs.cartonList.loadCartones();\r\n      } else {\r\n        console.warn('loadCartones no está disponible en CartonList');\r\n      }\r\n    },\r\n    async logout() {\r\n      try {\r\n        await signOut(auth);\r\n        this.$router.push('/login');\r\n        console.log('Sesión cerrada con éxito');\r\n        this.clearInactivityTimer();\r\n      } catch (error) {\r\n        console.error('Error al cerrar sesión:', error);\r\n        alert('Error al cerrar sesión: ' + error.message);\r\n      }\r\n    },\r\n    setupInactivityTimer() {\r\n      // Eventos que indican actividad del usuario\r\n      const events = ['mousemove', 'keydown', 'click', 'scroll'];\r\n      const resetTimer = () => {\r\n        this.clearInactivityTimer();\r\n        this.inactivityTimeout = setTimeout(() => {\r\n          this.logout();\r\n          alert('Sesión cerrada por inactividad de 15 minutos.');\r\n        }, this.inactivityLimit);\r\n      };\r\n\r\n      // Añadir listeners para los eventos\r\n      events.forEach(event => {\r\n        window.addEventListener(event, resetTimer);\r\n      });\r\n\r\n      // Iniciar el temporizador al montar el componente\r\n      resetTimer();\r\n    },\r\n    clearInactivityTimer() {\r\n      const events = ['mousemove', 'keydown', 'click', 'scroll'];\r\n      events.forEach(event => {\r\n        window.removeEventListener(event, () => {});\r\n      });\r\n      if (this.inactivityTimeout) {\r\n        clearTimeout(this.inactivityTimeout);\r\n        this.inactivityTimeout = null;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Animación de pulso para el logo */\r\n.animate-pulse {\r\n  animation: pulse 2s infinite ease-in-out;\r\n}\r\n\r\n@keyframes pulse {\r\n  0% {\r\n    transform: scale(1);\r\n    opacity: 1;\r\n  }\r\n  50% {\r\n    transform: scale(1.2);\r\n    opacity: 0.7;\r\n  }\r\n  100% {\r\n    transform: scale(1);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Sombras personalizadas */\r\n.shadow-3xl {\r\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAA2E;;EAE5EA,KAAK,EAAC;AAAwE;;EAC/EA,KAAK,EAAC;AAA+D;;EAetEA,KAAK,EAAC;AAA8B;;EACnCA,KAAK,EAAC;AAAqE;;EAEzEA,KAAK,EAAC;AAAsI;;EAM5IA,KAAK,EAAC;AAAsI;;EAM5IA,KAAK,EAAC;AAAsI;;EAM5IA,KAAK,EAAC;AAAsI;;;;;;uBAvCvJC,mBAAA,CA6CM,OA7CNC,UA6CM,GA5CJC,mBAAA,yBAA4B,EAC5BC,mBAAA,CAaS,UAbTC,UAaS,GAZPD,mBAAA,CAWM,OAXNE,UAWM,G,0BAVJF,mBAAA,CAGM;IAHDJ,KAAK,EAAC;EAA6B,IACtCI,mBAAA,CAA6E;IAAvEJ,KAAK,EAAC;EAAuD,GAAC,IAAE,GACtEI,mBAAA,CAA4E;IAAxEJ,KAAK,EAAC;EAA6C,GAAC,iBAAe,E,sBAEzEI,mBAAA,CAKS;IAJNG,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,MAAA,IAAAD,QAAA,CAAAC,MAAA,IAAAF,IAAA,CAAM;IACdT,KAAK,EAAC;KACP,iBAED,E,KAIJG,mBAAA,yBAA4B,EAC5BC,mBAAA,CA0BO,QA1BPQ,UA0BO,GAzBLR,mBAAA,CAwBM,OAxBNS,UAwBM,GAvBJV,mBAAA,+BAAkC,EAClCC,mBAAA,CAGM,OAHNU,UAGM,G,0BAFJV,mBAAA,CAAwF;IAApFJ,KAAK,EAAC;EAA0D,GAAC,gBAAc,sBACnFe,YAAA,CAA4FC,uBAAA;IAA7EC,iBAAgB,EAAEP,QAAA,CAAAQ,eAAe;IAAGC,gBAAe,EAAET,QAAA,CAAAU;wEAGtEjB,mBAAA,iCAAoC,EACpCC,mBAAA,CAGM,OAHNiB,UAGM,G,0BAFJjB,mBAAA,CAA0F;IAAtFJ,KAAK,EAAC;EAA0D,GAAC,kBAAgB,sBACrFe,YAAA,CAAuDO,wBAAA;IAAvCC,mBAAkB,EAAEb,QAAA,CAAAc;EAAe,iD,GAGrDrB,mBAAA,kCAAqC,EACrCC,mBAAA,CAGM,OAHNqB,UAGM,G,0BAFJrB,mBAAA,CAA2F;IAAvFJ,KAAK,EAAC;EAA0D,GAAC,mBAAiB,sBACtFe,YAAA,CAA+BW,qBAAA;IAAnBC,GAAG,EAAC;EAAY,+B,GAG9BxB,mBAAA,oCAAuC,EACvCC,mBAAA,CAGM,OAHNwB,UAGM,G,0BAFJxB,mBAAA,CAA6F;IAAzFJ,KAAK,EAAC;EAA0D,GAAC,qBAAmB,sBACxFe,YAAA,CAAcc,qBAAA,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}